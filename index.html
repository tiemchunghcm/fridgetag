<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>M√¥ ph·ªèng Fridge-tag ‚Äì T·∫≠p hu·∫•n d√¢y chuy·ªÅn l·∫°nh</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f7fb;
      display: flex;
      justify-content: center;
      padding: 20px;
    }

    .app {
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      padding: 20px 24px;
      max-width: 600px;
      width: 100%;
    }

    h1 {
      font-size: 20px;
      margin-top: 0;
      margin-bottom: 8px;
      text-align: center;
    }

    .subtitle {
      text-align: center;
      font-size: 13px;
      color: #666;
      margin-bottom: 16px;
    }

    .display {
      border-radius: 12px;
      background: #111;
      color: #0f0;
      padding: 16px;
      display: grid;
      grid-template-columns: 1.3fr 1fr;
      gap: 12px;
      align-items: center;
      margin-bottom: 16px;
    }

    .temp-block {
      text-align: center;
      border-right: 1px solid rgba(255,255,255,0.1);
    }

    .temp-value {
      font-size: 40px;
      font-weight: 600;
    }

    .temp-unit {
      font-size: 16px;
      opacity: 0.8;
    }

    .status-block {
      font-size: 13px;
      line-height: 1.5;
    }

    .status-label {
      color: #aaa;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .06em;
    }

    .status-text {
      margin-bottom: 4px;
    }

    .alarm {
      color: #ff5555;
    }

    .ok-status {
      color: #7CFC00;
    }

    .time-row {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      margin-bottom: 6px;
      color: #eee;
    }

    .chip {
      font-size: 11px;
      border-radius: 999px;
      padding: 2px 8px;
      border: 1px solid rgba(255,255,255,0.25);
      margin-left: 4px;
    }

    .panel {
      background: #ffffff;
      border-radius: 12px;
      padding: 12px 14px;
      margin-bottom: 12px;
      border: 1px solid #e4e7f0;
    }

    .panel-title {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .panel-desc {
      font-size: 12px;
      color: #666;
      margin-bottom: 8px;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 4px;
    }

    button {
      border-radius: 999px;
      border: 1px solid #d0d4e4;
      background: #f8f9ff;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: background 0.15s, transform 0.05s, box-shadow 0.15s;
    }

    button:hover {
      background: #e6edff;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: none;
    }

    .btn-primary {
      background: #2563eb;
      color: white;
      border-color: #2563eb;
    }

    .btn-primary:hover {
      background: #1d4ed8;
    }

    .btn-danger {
      background: #fee2e2;
      border-color: #fecaca;
      color: #b91c1c;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 10px;
    }

    .legend {
      font-size: 11px;
      color: #555;
      line-height: 1.5;
    }

    .badge-alarm {
      display: inline-block;
      font-size: 11px;
      border-radius: 999px;
      padding: 2px 7px;
      background: #fee2e2;
      color: #b91c1c;
      margin-left: 6px;
    }

    .badge-safe {
      display: inline-block;
      font-size: 11px;
      border-radius: 999px;
      padding: 2px 7px;
      background: #dcfce7;
      color: #166534;
      margin-left: 6px;
    }

    .note {
      font-size: 11px;
      color: #777;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>M√¥ ph·ªèng Fridge-tag</h1>
    <div class="subtitle">
      D√πng cho t·∫≠p hu·∫•n d√¢y chuy·ªÅn l·∫°nh ‚Äì nh·∫•n n√∫t, thay ƒë·ªïi nhi·ªát ƒë·ªô, ch·ªù b√°o ƒë·ªông.
    </div>

    <!-- M√†n h√¨nh "Fridge-tag" -->
    <div class="display" id="display">
      <div class="temp-block">
        <div class="temp-value">
          <span id="tempValue">5.0</span><span class="temp-unit"> ¬∞C</span>
        </div>
        <div class="time-row">
          <span>T·ªïng th·ªùi gian: <strong id="totalTime">00:00</strong></span>
        </div>
        <div class="time-row">
          <span>> 8¬∞C: <strong id="highOor">0 ph√∫t</strong></span>
          <span>< 2¬∞C: <strong id="lowOor">0 ph√∫t</strong></span>
        </div>
      </div>
      <div class="status-block">
        <div class="status-label">Tr·∫°ng th√°i</div>
        <div class="status-text" id="statusText">
          Trong ng∆∞·ª°ng an to√†n (2 ‚Äì 8¬∞C)
        </div>
        <div class="status-label">B√°o ƒë·ªông</div>
        <div class="status-text" id="alarmText">
          Kh√¥ng c√≥ b√°o ƒë·ªông
        </div>
        <div class="status-label">Ch·∫ø ƒë·ªô m√¥ ph·ªèng</div>
        <div class="status-text">
          1 gi√¢y = <strong>10 ph√∫t</strong>
        </div>
      </div>
    </div>

    <!-- N√∫t ƒëi·ªÅu khi·ªÉn gi·ªëng m√°y -->
    <div class="panel">
      <div class="panel-title">N√∫t gi·ªëng tr√™n Fridge-tag</div>
      <div class="panel-desc">
        D√πng ƒë·ªÉ cho h·ªçc vi√™n th·ª±c h√†nh ƒë·ªçc m√†n h√¨nh v√† x·ª≠ tr√≠ b√°o ƒë·ªông.
      </div>
      <div class="btn-row">
        <button class="btn-primary" id="btnStartStop">‚ñ∂ B·∫Øt ƒë·∫ßu m√¥ ph·ªèng</button>
        <button id="btnReset">‚ü≤ Reset</button>
        <button id="btnTempUp">‚ñ≤ TƒÉng 0,5¬∞C</button>
        <button id="btnTempDown">‚ñº Gi·∫£m 0,5¬∞C</button>
        <button class="btn-danger" id="btnOk">OK ‚Äì X√°c nh·∫≠n b√°o ƒë·ªông</button>
      </div>
      <div class="note">
        G·ª£i √Ω khi d·∫°y: y√™u c·∫ßu h·ªçc vi√™n <strong>ghi l·∫°i s·ªë ƒë·ªçc</strong>, <strong>th·ªùi gian ph∆°i nhi·ªÖm</strong>
        tr∆∞·ªõc khi nh·∫•n n√∫t <strong>OK</strong>.
      </div>
    </div>

    <!-- K·ªãch b·∫£n m√¥ ph·ªèng -->
    <div class="grid-2">
      <div class="panel">
        <div class="panel-title">
          K·ªãch b·∫£n 1: TƒÉng nhi·ªát > 8¬∞C
          <span class="badge-alarm">ALARM > 8¬∞C sau 3 gi·ªù</span>
        </div>
        <div class="panel-desc">
          D√πng ƒë·ªÉ minh h·ªça t·ªß l·∫°nh m·∫•t l·∫°nh (c·ª≠a m·ªü nhi·ªÅu, m·∫•t ƒëi·ªán...). H·ªçc vi√™n quan s√°t th·ªùi gian
          ph∆°i nhi·ªÖm v√† quy·∫øt ƒë·ªãnh x·ª≠ tr√≠ v·∫Øc xin.
        </div>
        <div class="btn-row">
          <button id="btnScenarioWarm">üî• B·∫Øt ƒë·∫ßu s·ªëc nhi·ªát (12¬∞C)</button>
        </div>
        <div class="legend">
          Ng∆∞·ª°ng m√¥ ph·ªèng:
          <ul>
            <li>Gi·ªõi h·∫°n tr√™n: <strong>8¬∞C</strong></li>
            <li>B√°o ƒë·ªông khi > 8¬∞C li√™n t·ª•c ‚â• <strong>3 gi·ªù</strong> (180 ph√∫t)</li>
          </ul>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">
          K·ªãch b·∫£n 2: ƒê√¥ng bƒÉng < 2¬∞C
          <span class="badge-alarm">ALARM < 2¬∞C sau 1 gi·ªù</span>
        </div>
        <div class="panel-desc">
          M√¥ ph·ªèng t·ªß l·∫°nh qu√° l·∫°nh (v·∫Øc xin s√°t d√†n l·∫°nh, ch·ªânh nhi·ªát ƒë·ªô qu√° th·∫•p...).
        </div>
        <div class="btn-row">
          <button id="btnScenarioCold">‚ùÑ S·ªëc l·∫°nh (-3¬∞C)</button>
        </div>
        <div class="legend">
          Ng∆∞·ª°ng m√¥ ph·ªèng:
          <ul>
            <li>Gi·ªõi h·∫°n d∆∞·ªõi: <strong>2¬∞C</strong></li>
            <li>B√°o ƒë·ªông khi < 2¬∞C li√™n t·ª•c ‚â• <strong>1 gi·ªù</strong> (60 ph√∫t)</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="note">
      L∆∞u √Ω: ƒê√¢y ch·ªâ l√† m√¥ ph·ªèng d√πng cho t·∫≠p hu·∫•n, <strong>kh√¥ng thay th·∫ø thi·∫øt b·ªã Fridge-tag th·∫≠t</strong>.
      C√≥ th·ªÉ ƒëi·ªÅu ch·ªânh ng∆∞·ª°ng v√† th·ªùi gian b√°o ƒë·ªông trong ph·∫ßn JavaScript ƒë·ªÉ ph√π h·ª£p h∆∞·ªõng d·∫´n qu·ªëc gia / h√£ng s·∫£n xu·∫•t.
    </div>
  </div>

  <script>
    // Tham s·ªë m√¥ ph·ªèng
    const HIGH_LIMIT = 8.0;            // Gi·ªõi h·∫°n tr√™n
    const LOW_LIMIT = 2.0;             // Gi·ªõi h·∫°n d∆∞·ªõi
    const HIGH_ALARM_THRESHOLD = 180;  // ph√∫t > 8¬∞C ƒë·ªÉ b√°o ƒë·ªông (3 gi·ªù)
    const LOW_ALARM_THRESHOLD = 60;    // ph√∫t < 2¬∞C ƒë·ªÉ b√°o ƒë·ªông (1 gi·ªù)
    const MIN_PER_TICK = 10;           // 1 tick (1 gi√¢y th·∫≠t) = 10 ph√∫t m√¥ ph·ªèng

    let currentTemp = 5.0;
    let totalMinutes = 0;
    let highOorMinutes = 0;  // out-of-range high
    let lowOorMinutes = 0;   // out-of-range low
    let alarmHigh = false;
    let alarmLow = false;
    let running = false;
    let intervalId = null;

    const tempEl = document.getElementById('tempValue');
    const totalTimeEl = document.getElementById('totalTime');
    const highOorEl = document.getElementById('highOor');
    const lowOorEl = document.getElementById('lowOor');
    const statusTextEl = document.getElementById('statusText');
    const alarmTextEl = document.getElementById('alarmText');
    const displayEl = document.getElementById('display');
    const btnStartStop = document.getElementById('btnStartStop');

    function formatMinutes(min) {
      const m = Math.floor(min);
      const hh = Math.floor(m / 60);
      const mm = m % 60;
      const pad = (x) => String(x).padStart(2, '0');
      return `${pad(hh)}:${pad(mm)}`;
    }

    function updateDisplay() {
      tempEl.textContent = currentTemp.toFixed(1);
      totalTimeEl.textContent = formatMinutes(totalMinutes);
      highOorEl.textContent = `${Math.round(highOorMinutes)} ph√∫t`;
      lowOorEl.textContent = `${Math.round(lowOorMinutes)} ph√∫t`;

      // Tr·∫°ng th√°i chung
      if (alarmHigh || alarmLow) {
        statusTextEl.innerHTML =
          alarmHigh
            ? `<span class="alarm">B√ÅO ƒê·ªòNG: Nhi·ªát ƒë·ªô cao k√©o d√†i</span>`
            : `<span class="alarm">B√ÅO ƒê·ªòNG: Nguy c∆° ƒë√¥ng bƒÉng</span>`;
        displayEl.style.boxShadow = '0 0 18px rgba(239,68,68,0.8)';
      } else {
        if (currentTemp >= LOW_LIMIT && currentTemp <= HIGH_LIMIT) {
          statusTextEl.innerHTML =
            `<span class="ok-status">Trong ng∆∞·ª°ng an to√†n (2 ‚Äì 8¬∞C)</span>`;
        } else if (currentTemp > HIGH_LIMIT) {
          statusTextEl.innerHTML =
            `<span class="alarm">ƒêang tr√™n 8¬∞C ‚Äì theo d√µi s√°t</span>`;
        } else {
          statusTextEl.innerHTML =
            `<span class="alarm">ƒêang d∆∞·ªõi 2¬∞C ‚Äì nguy c∆° ƒë√¥ng bƒÉng</span>`;
        }
        displayEl.style.boxShadow = '0 8px 24px rgba(0,0,0,0.2)';
      }

      // N·ªôi dung alarm chi ti·∫øt
      if (alarmHigh) {
        alarmTextEl.innerHTML =
          `ALARM HIGH: > 8¬∞C li√™n t·ª•c ‚â• 3 gi·ªù<br><span style="color:#aaa;font-size:11px;">Th·ª±c h√†nh: c√°ch ly v·∫Øc xin, ghi nh·∫≠n, b√°o c√°o, ƒë√°nh gi√° s·ª≠ d·ª•ng ti·∫øp.</span>`;
      } else if (alarmLow) {
        alarmTextEl.innerHTML =
          `ALARM LOW: < 2¬∞C li√™n t·ª•c ‚â• 1 gi·ªù<br><span style="color:#aaa;font-size:11px;">Th·ª±c h√†nh: ki·ªÉm tra nguy c∆° ƒë√¥ng bƒÉng, x·ª≠ tr√≠ theo h∆∞·ªõng d·∫´n.</span>`;
      } else {
        alarmTextEl.textContent = 'Kh√¥ng c√≥ b√°o ƒë·ªông';
      }
    }

    function tick() {
      // M·ªói tick c·ªông 10 ph√∫t
      totalMinutes += MIN_PER_TICK;

      // Theo d√µi ph∆°i nhi·ªÖm
      if (currentTemp > HIGH_LIMIT) {
        highOorMinutes += MIN_PER_TICK;
      } else {
        highOorMinutes = 0;
      }

      if (currentTemp < LOW_LIMIT) {
        lowOorMinutes += MIN_PER_TICK;
      } else {
        lowOorMinutes = 0;
      }

      // K√≠ch ho·∫°t b√°o ƒë·ªông n·∫øu ƒë·ªß th·ªùi gian
      if (highOorMinutes >= HIGH_ALARM_THRESHOLD) {
        alarmHigh = true;
      }
      if (lowOorMinutes >= LOW_ALARM_THRESHOLD) {
        alarmLow = true;
      }

      updateDisplay();
    }

    function start() {
      if (running) return;
      running = true;
      btnStartStop.textContent = '‚è∏ T·∫°m d·ª´ng';
      intervalId = setInterval(tick, 1000); // 1 gi√¢y th·∫≠t
    }

    function stop() {
      running = false;
      btnStartStop.textContent = '‚ñ∂ Ti·∫øp t·ª•c m√¥ ph·ªèng';
      if (intervalId) {
        clearInterval(intervalId);
        intervalId = null;
      }
    }

    function resetAll() {
      stop();
      currentTemp = 5.0;
      totalMinutes = 0;
      highOorMinutes = 0;
      lowOorMinutes = 0;
      alarmHigh = false;
      alarmLow = false;
      btnStartStop.textContent = '‚ñ∂ B·∫Øt ƒë·∫ßu m√¥ ph·ªèng';
      updateDisplay();
    }

    // G√°n s·ª± ki·ªán n√∫t
    btnStartStop.addEventListener('click', () => {
      if (running) {
        stop();
      } else {
        start();
      }
    });

    document.getElementById('btnReset').addEventListener('click', () => {
      resetAll();
    });

    document.getElementById('btnTempUp').addEventListener('click', () => {
      currentTemp += 0.5;
      updateDisplay();
    });

    document.getElementById('btnTempDown').addEventListener('click', () => {
      currentTemp -= 0.5;
      updateDisplay();
    });

    document.getElementById('btnOk').addEventListener('click', () => {
      // Gi·ªëng nh·∫•n OK: xo√° tr·∫°ng th√°i b√°o ƒë·ªông nh∆∞ng KH√îNG xo√° nhi·ªát ƒë·ªô & t·ªïng th·ªùi gian
      alarmHigh = false;
      alarmLow = false;
      highOorMinutes = 0;
      lowOorMinutes = 0;
      updateDisplay();
      alert('Gi·∫£ ƒë·ªãnh: Anh/ch·ªã ƒë√£ ghi ch√©p v√† x·ª≠ tr√≠, sau ƒë√≥ nh·∫•n OK ƒë·ªÉ x√°c nh·∫≠n b√°o ƒë·ªông.');
    });

    // K·ªãch b·∫£n: s·ªëc nhi·ªát
    document.getElementById('btnScenarioWarm').addEventListener('click', () => {
      currentTemp = 12.0;
      updateDisplay();
    });

    // K·ªãch b·∫£n: s·ªëc l·∫°nh
    document.getElementById('btnScenarioCold').addEventListener('click', () => {
      currentTemp = -3.0;
      updateDisplay();
    });

    // Kh·ªüi t·∫°o hi·ªÉn th·ªã
    updateDisplay();
  </script>
</body>
</html>
